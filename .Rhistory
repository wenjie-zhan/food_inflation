################################################################################
##### Project: food inflation
##### Program: cex processing
##### Coding: Wenjie Zhan
################################################################################
# Clean the Environment
rm(list=ls())
# Loading packages
library(tidyverse)
library(tidycensus)
library(data.table)
library(dplyr)
library(ggplot2)
library(sandwich) # vcov
library(usmap) # us map with HI and AK
library(magrittr) # %$%
library(plotrix) # std.error()
library(haven) # read_dta()
library(readr)
################################################################################
##### 1. Import CEX data: expenditure and demographic characteristics
################################################################################
# Import fmld and expd data
fmld <- c()
expd <- c()
for (yr in 1:13) {
dr_tmp <- paste("cex_data/diary_data/diary_data_raw/diary", (yr + 9), sep = "")
fmld[[yr]] <- list(NA)
expd[[yr]] <- list(NA)
for (qt in 1:4) {
fmld[[yr]][[qt]] <- paste(dr_tmp, "/fmld", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(fmld[[yr]][[qt]]) <- fmld[[yr]][[qt]] %>% names() %>% tolower()
expd[[yr]][[qt]] <- paste(dr_tmp, "/expd", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(expd[[yr]][[qt]]) <- expd[[yr]][[qt]] %>% names() %>% tolower()
}
}
View(expd)
################################################################################
##### Project: food inflation
##### Program: cex processing
##### Coding: Wenjie Zhan
################################################################################
# Clean the Environment
rm(list=ls())
# Loading packages
library(tidyverse)
library(tidycensus)
library(data.table)
library(dplyr)
library(ggplot2)
library(sandwich) # vcov
library(usmap) # us map with HI and AK
library(magrittr) # %$%
library(plotrix) # std.error()
library(haven) # read_dta()
library(readr)
################################################################################
##### 1. Import CEX data: expenditure and demographic characteristics
################################################################################
# Import fmld and expd data
fmld <- c()
expd <- c()
for (yr in 1:13) {
dr_tmp <- paste("cex_data/diary_data/diary_data_raw/diary", (yr + 9), sep = "")
fmld[[yr]] <- list(NA)
expd[[yr]] <- list(NA)
for (qt in 1:4) {
fmld[[yr]][[qt]] <- paste(dr_tmp, "/fmld", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(fmld[[yr]][[qt]]) <- fmld[[yr]][[qt]] %>% names() %>% tolower()
expd[[yr]][[qt]] <- paste(dr_tmp, "/expd", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(expd[[yr]][[qt]]) <- expd[[yr]][[qt]] %>% names() %>% tolower()
}
}
fmld <- c()
expd <- c()
for (yr in 1:13) {
dr_tmp <- paste("C:/Users/wenji/OneDrive/Documents/GitHub/food_inflation/cex_data/diary_data/diary_data_raw/diary", (yr + 9), sep = "")
fmld[[yr]] <- list(NA)
expd[[yr]] <- list(NA)
for (qt in 1:4) {
fmld[[yr]][[qt]] <- paste(dr_tmp, "/fmld", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(fmld[[yr]][[qt]]) <- fmld[[yr]][[qt]] %>% names() %>% tolower()
expd[[yr]][[qt]] <- paste(dr_tmp, "/expd", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(expd[[yr]][[qt]]) <- expd[[yr]][[qt]] %>% names() %>% tolower()
}
}
for (yr in 1:13) {
dr_tmp <- paste("C:/Users/wenji/OneDrive/文档/GitHub/food_inflation/cex_data/diary_data/diary_data_raw/diary", (yr + 9), sep = "")
fmld[[yr]] <- list(NA)
expd[[yr]] <- list(NA)
for (qt in 1:4) {
fmld[[yr]][[qt]] <- paste(dr_tmp, "/fmld", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(fmld[[yr]][[qt]]) <- fmld[[yr]][[qt]] %>% names() %>% tolower()
expd[[yr]][[qt]] <- paste(dr_tmp, "/expd", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(expd[[yr]][[qt]]) <- expd[[yr]][[qt]] %>% names() %>% tolower()
}
}
setwd("C:/Users/wenji/OneDrive/文档/GitHub/food_inflation/")
fmld <- c()
expd <- c()
for (yr in 1:13) {
dr_tmp <- paste("cex_data/diary_data/diary_data_raw/diary", (yr + 9), sep = "")
fmld[[yr]] <- list(NA)
expd[[yr]] <- list(NA)
for (qt in 1:4) {
fmld[[yr]][[qt]] <- paste(dr_tmp, "/fmld", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(fmld[[yr]][[qt]]) <- fmld[[yr]][[qt]] %>% names() %>% tolower()
expd[[yr]][[qt]] <- paste(dr_tmp, "/expd", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(expd[[yr]][[qt]]) <- expd[[yr]][[qt]] %>% names() %>% tolower()
}
}
ap_dta <- read.delim("~/GitHub/food_inflation/bls_price_data/ap.data.3.Food.txt") %>%
mutate(unadj = ifelse(substr(series_id, 3, 3) == "U", 1, 0),
area_code = substr(series_id, 4, 7),
item_code = substr(series_id, 8, 13)
) %>%
mutate(
area = case_when(
area_code == "0000" ~ "City Average",
area_code == "0100" ~ "Northeast",
area_code == "0200" ~ "Midwest",
area_code == "0300" ~ "South",
area_code == "0400" ~ "West"
)
)
ap_dta <- read.delim("bls_price_data/ap.data.3.Food.txt") %>%
mutate(unadj = ifelse(substr(series_id, 3, 3) == "U", 1, 0),
area_code = substr(series_id, 4, 7),
item_code = substr(series_id, 8, 13)
) %>%
mutate(
area = case_when(
area_code == "0000" ~ "City Average",
area_code == "0100" ~ "Northeast",
area_code == "0200" ~ "Midwest",
area_code == "0300" ~ "South",
area_code == "0400" ~ "West"
)
)
setwd("C:/Users/wenji/OneDrive/Documents/GitHub/food_inflation/")
fmld <- c()
expd <- c()
for (yr in 1:13) {
dr_tmp <- paste("cex_data/diary_data/diary_data_raw/diary", (yr + 9), sep = "")
fmld[[yr]] <- list(NA)
expd[[yr]] <- list(NA)
for (qt in 1:4) {
fmld[[yr]][[qt]] <- paste(dr_tmp, "/fmld", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(fmld[[yr]][[qt]]) <- fmld[[yr]][[qt]] %>% names() %>% tolower()
expd[[yr]][[qt]] <- paste(dr_tmp, "/expd", (yr + 9)*10 + qt, ".csv", sep = "") %>% read.csv()
names(expd[[yr]][[qt]]) <- expd[[yr]][[qt]] %>% names() %>% tolower()
}
}
cpi_dta <- read.delim("bls_price_data/cu.data.11.USFoodBeverage.txt")
cpi_dta <- read.delim("bls_price_data/cu.data.11.USFoodBeverage.txt") %>%
mutate(unadj = ifelse(substr(series_id, 3, 3) == "U", 1, 0),
monthly = ifelse(substr(series_id, 4, 4) == "R", 1, 0),
area_code = substr(series_id, 5, 8),
base82_84 = ifelse(substr(series_id, 9, 9) == "S", 1, 0),
item_code = substr(series_id, 10, 16)
)
summary(as.factor(cpi_dta$base82_84))
summary(as.factor(cpi_dta$monthly))
summary(as.factor(cpi_dta$area_code))
View(cpi_dta)
summary(as.factor(cpi_dta$item_code))
View(ap_dta)
fmld_wd <- c()
expd_wd <- c()
